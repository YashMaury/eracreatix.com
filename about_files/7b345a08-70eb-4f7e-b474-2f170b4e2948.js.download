async function h(w){if(!w)return;var _w$navigator,_w$location,_d$referrer;document.addEventListener("click",async function(){try{const cookies=document.cookie;const cookieArray=cookies.split("; ");const cookiesObject={};for(let i=0;i<cookieArray.length;i++){const[cookieName,cookieValue]=cookieArray[i].split("=");cookiesObject[cookieName]=cookieValue;}
if(cookiesObject["cart"]){console.log("CART FOUND!");const prevCartToken=window.localStorage.getItem("prev_cart");if(prevCartToken!==cookiesObject["cart"]){if(cookiesObject["oia_mapping"]!=="1"){const oiaIdentifier=window.sessionStorage.getItem("openinapp");const cartValue=cookiesObject["cart"];const storedData=window.localStorage.getItem("oia_shopify");const parsedData=JSON.parse(storedData);if(oiaIdentifier&&cartValue){console.log("Creating mapping");await fetch("https://apishopify.openinapp.com/api/v1/mapping/save-cart?cartId="+
cartValue+
"&shopId="+
parsedData.shop_id);document.cookie="oia_mapping=1; path=/";window.localStorage.setItem("prev_cart",cookiesObject["cart"]);}}}else{document.cookie="oia_mapping=0; path=/";}}else{document.cookie="oia_mapping=0; path=/";}}catch(e){console.log(e);}});var myHeaders=new Headers();myHeaders.append('Content-Type','application/json');var raw={user_id:'7b345a08-70eb-4f7e-b474-2f170b4e2948',user_agent:w===null||w===undefined?undefined:w.navigator===null||w.navigator===undefined?undefined:w.navigator.userAgent,source_url:w===null||w===undefined?undefined:w.location===null||w.location===undefined?undefined:w.location.href,referrer:w===null||w===undefined?undefined:w.document===null||w.document===undefined?undefined:w.document.referrer,};var requestOptions={method:'POST',headers:myHeaders,redirect:'follow',};try{var redirected=window.sessionStorage.getItem('redirected');if(!redirected){var sessionId=window.sessionStorage.getItem('sessionId');if(sessionId){raw.session_id=sessionId;}
requestOptions.body=JSON.stringify(raw);var res=await fetch('https://helper.openinapp.com/api/v1/link/parse-url-agent',requestOptions);var result=await res.json();window.sessionStorage.setItem('redirected',true);if(result&&result.data&&result.data.url!=''){window.location.href=result.data.url.replace("http://","");}else{return;}}}catch(err){console.log(err);}}
h(window);