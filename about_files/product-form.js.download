customElements.get("product-form")||customElements.define("product-form",class extends HTMLElement{constructor(){if(super(),this.form=this.querySelector("form"),this.form.querySelector("[name=id]").disabled=!1,this.form.addEventListener("submit",this.onSubmitHandler.bind(this)),this.cart=document.querySelector("cart-notification")||document.querySelector("cart-drawer"),this.submitButton=this.querySelector('[type="submit"]'),document.querySelector("cart-drawer")&&this.submitButton.setAttribute("aria-haspopup","dialog"),this.hideErrors=this.dataset.hideErrors==="true",this.submitButton.getAttribute("data-pr-no-pick")!=="true"&&this.submitButton.classList.contains("product-form-atc")){let self=this;setInterval(function(){self.submitButton.classList.add("is--atc-animated"),setTimeout(function(){self.submitButton.classList.remove("is--atc-animated")},1e3)},8e3)}}onSubmitHandler(evt){if(this.pr_no_pick=this.submitButton.getAttribute("data-pr-no-pick"),evt.preventDefault(),this.submitButton.getAttribute("aria-disabled")==="true")return;if(this.pr_no_pick=="true"){const errorBanner=document.querySelector(".swatch_banner");errorBanner.classList.add("swatch_banner_animator"),errorBanner.removeAttribute("style"),errorBanner.style.cssText="display: flex;",setTimeout(function(){errorBanner.classList.remove("swatch_banner_animator"),document.querySelector("#swatch-error").scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},400);return}this.handleErrorMessage(),this.submitButton.setAttribute("aria-disabled",!0),this.submitButton.classList.add("loading"),this.submitButton.hasAttribute("data-action-atc-fp")&&document.getElementById("spinner-container")&&(document.getElementById("spinner-container").removeAttribute("hidden"),document.getElementById("spinner-container").classList.add("spinner-show")),this.querySelector(".loading__spinner").classList.remove("hidden");const config=fetchConfig("javascript");config.headers["X-Requested-With"]="XMLHttpRequest",delete config.headers["Content-Type"];const formData=new FormData(this.form);this.cart&&(formData.append("sections",this.cart.getSectionsToRender().map(section=>section.id)),formData.append("sections_url",window.location.pathname),this.cart.setActiveElement(document.activeElement)),config.body=formData,fetch(`${routes.cart_add_url}`,config).then(response=>response.json()).then(async response=>{if(response.status){publish(PUB_SUB_EVENTS.cartError,{source:"product-form",productVariantId:formData.get("id"),errors:response.errors||response.description,message:response.message}),this.handleErrorMessage(response.description);const soldOutMessage=this.submitButton.querySelector(".sold-out-message");if(!soldOutMessage)return;this.submitButton.setAttribute("aria-disabled",!0),this.submitButton.querySelector("span").classList.add("hidden"),soldOutMessage.classList.remove("hidden"),this.error=!0;return}else if(!this.cart){window.location=window.routes.cart_url;return}this.error||publish(PUB_SUB_EVENTS.cartUpdate,{source:"product-form",productVariantId:formData.get("id"),cartData:response}),this.error=!1;const quickAddModal=this.closest("quick-add-modal");quickAddModal?(document.body.addEventListener("modalClosed",()=>{setTimeout(()=>{this.cart.renderContents(response)})},{once:!0}),quickAddModal.hide(!0)):this.cart.renderContents(response),this.submitButton.hasAttribute("data-action-atc-fp")&&document.getElementById("spinner-container")&&(document.getElementById("spinner-container").removeAttribute("hidden"),document.getElementById("spinner-container").classList.add("spinner-show")),this.submitButton.hasAttribute("data-action-atc-fp")?await document.querySelector("coupons-cart")?.handleClaimGiftClick(this.submitButton):await document.querySelector("coupons-cart")?.autoApplyCoupon()}).catch(e=>{console.error(e)}).finally(()=>{this.submitButton.classList.remove("loading"),this.cart&&this.cart.classList.contains("is-empty")&&this.cart.classList.remove("is-empty"),this.error||this.submitButton.removeAttribute("aria-disabled"),this.querySelector(".loading__spinner").classList.add("hidden"),this.submitButton.hasAttribute("data-action-atc-fp")&&document.getElementById("spinner-container")&&(document.getElementById("spinner-container").setAttribute("hidden",""),document.getElementById("spinner-container").classList.remove("spinner-show"))})}handleErrorMessage(errorMessage=!1){this.hideErrors||(this.errorMessageWrapper=this.errorMessageWrapper||this.querySelector(".product-form__error-message-wrapper"),this.errorMessageWrapper&&(this.errorMessage=this.errorMessage||this.errorMessageWrapper.querySelector(".product-form__error-message"),this.errorMessageWrapper.toggleAttribute("hidden",!errorMessage),errorMessage&&(this.errorMessage.textContent=errorMessage)))}});
//# sourceMappingURL=/cdn/shop/t/674/assets/product-form.js.map?v=27844294330404436081715771437
